<div class="tableau-container">
  <iframe
    src="<%= project.tableauUrl %>&:showVizHome=no&:embed=true"
    width="100%"
    height="600"
    style="border:none;"
    loading="lazy"
    title="<%= project.title %> Visualization"
    onerror="showFallback(this)"
  ></iframe>

  <div class="tableau-fallback" style="display:none;">
    <p>Embed disabled. View the visualization directly:</p>
    <a href="<%= project.tableauUrl.replace('?:embed=true', '') %>" target="_blank">
      Open in Tableau Public
    </a>
    <img src="/images/viz-screenshot.jpg" alt="Backup visualization screenshot">
  </div>
</div>

<script>
  function showFallback(iframe) {
    iframe.style.display = 'none';
    document.querySelector('.tableau-fallback').style.display = 'block';
  }
</script>

<style>
  .tableau-container {
    position: relative;
    min-height: 600px;
  }
  .tableau-fallback {
    border: 2px dashed #ccc;
    padding: 2rem;
    text-align: center;
  }
  .tableau-fallback img {
    max-width: 100%;
    margin-top: 1rem;
  }
</style>